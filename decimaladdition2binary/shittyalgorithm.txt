WTF is this shitty algorithm. Pls change.